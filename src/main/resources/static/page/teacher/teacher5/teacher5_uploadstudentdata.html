<!DOCTYPE html>
<html class="x-admin-sm" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <title>信阳农林学院毕业论文指导过程管理系统</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport"
          content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi"/>
    <link rel="stylesheet" href="/css/font.css">
    <link rel="stylesheet" href="/css/xadmin.css">
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.min.css" rel="stylesheet">
    <link href="/lib/layui/css/layui.css" rel="stylesheet">
    <link href="/css/materialdesignicons.min.css" rel="stylesheet">
    <script src="/lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="/js/xadmin.js"></script>
    <script type="text/javascript" src="/js/excel.js"></script>
    <script type="text/javascript" src="/js/own/public.js"></script>
    <script type="text/javascript" src="/js/own/teacher4.js"></script>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<style type="text/css">
    .layui-table-body {
        overflow-x: hidden;
    }
</style>
<body>
<div class="layui-fluid">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md12">
            <!--自定义页面内容-->

            <!--tips-->
            <div class="layui-card">
                <div class="layui-card-body ">
                    <blockquote class="layui-elem-quote">
                        您可在此处选择性开启或关闭特定功能!
                    </blockquote>
                </div>
            </div>
            <!--END tips-->

            <!--小组-->
            <div style="padding: 20px; background-color: #887777;">
                <div class="layui-row layui-col-space15">
                    <div class="layui-col-md12">
                        <div class="layui-card">
                            <div class="layui-card-body" style="display:inline-block;width: 100%">
                                <!--核心元素-->
                                <fieldset class="layui-elem-field">
                                    <legend style="color: black;">学生</legend>
                                    <div class="layui-field-box">
                                        <form class="layui-form" style="font-size: 15px">
                                            <div class="layui-form-item" style="float: left;">
                                                <label class="layui-form-label" style="width: 120px">自拟题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="自拟题目1" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">定题</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="定题1" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">选择小组</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="选择小组1" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">开题报告</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="开题报告1" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;">
                                                <label class="layui-form-label" style="width: 120px">中期检查表</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="中期检查表1" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">毕业论文</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="毕业论文1" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </fieldset>
                                <hr class="layui-bg-black" style="margin-top: 30px;margin-bottom: 30px">
                                <fieldset class="layui-elem-field">
                                    <legend>普通教师(2级权限)</legend>
                                    <div class="layui-field-box">
                                        <form class="layui-form" style="font-size: 15px">
                                            <div class="layui-form-item" style="float: left">
                                                <label class="layui-form-label" style="width: 120px">拟定题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="拟定题目2" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">论文题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="论文题目2" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">开题报告</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="开题报告2" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">中期检查表</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="中期检查表2" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 0%">
                                                <label class="layui-form-label" style="width: 120px">毕业论文</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="毕业论文2" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </fieldset>
                                <hr class="layui-bg-black" style="margin-top: 30px;margin-bottom: 30px">
                                <fieldset class="layui-elem-field">
                                    <legend>小组组长或秘书(三级权限)</legend>
                                    <div class="layui-field-box">
                                        <form class="layui-form" style="font-size: 15px">
                                            <div class="layui-form-item" style="float: left;">
                                                <label class="layui-form-label" style="width: 120px">按学生分配指导教师</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="按学生分配3" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">按教师分配指导教师</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="按教师分配3" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </fieldset>
                                <hr class="layui-bg-black" style="margin-top: 30px;margin-bottom: 30px">
                                <fieldset class="layui-elem-field">
                                    <legend>教研室主任(4级权限)</legend>
                                    <div class="layui-field-box">
                                        <form class="layui-form" style="font-size: 15px">
                                            <div class="layui-form-item" style="float: left;">
                                                <label class="layui-form-label" style="width: 120px">自拟题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="自拟题目" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">拟定类别</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="拟定类别4" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">审核学生题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="学生题目4" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">审核教师题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="教师题目4" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;">
                                                <label class="layui-form-label" style="width: 120px">导出题目</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="导出题目4" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                            <div class="layui-form-item" style="float: left;clear: none;margin-left: 15%">
                                                <label class="layui-form-label" style="width: 120px">新建小组</label>
                                                <div class="layui-input-block" style="width: 80px">
                                                    <input type="checkbox" name="新建小组4" id="新建小组" lay-skin="switch" lay-filter="switchTest" lay-text="ON|OFF">
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                </fieldset>
                                <!--END核心元素-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--END小组-->
            <!--END自定义页面内容-->
        </div>
    </div>
</div>
</div>



<script>
    layui.use(['form', 'layer', 'util', 'transfer', 'element','table'], function () {
        var form = layui.form
            , layer = layui.layer
            , util = layui.util
            , transfer = layui.transfer
            ,table=layui.table
            , element = layui.element;

        /*加载数据*/
        $.ajax({
            url: "/power/allpower",
            type: 'post',
            async: true,
            cache: false,
            success: function (result) {
                if (result.res) {
                    var data=result.data;
                    console.log(data);
                    for (let i=0;i<data.length;i++){
                        if (data[i].onoff) {
                            /*$('#'+data[i].power+'').attr("checked",true);*/
                            $('input:checkbox[name='+data[i].power+data[i].funlevel+']').attr("checked",true);
                        }
                    }
                    form.render();
                } else {
                    layer.msg(result.msg, {icon: 5})
                }
            }
        });
        /*END加载数据*/

        /*监听开关*/
        form.on('switch(switchTest)', function(data){
            console.log(data.elem.getAttribute('name'));
            var rel1=/[\u4e00-\u9fa5]{2,}/;//匹配中文字符
            var rel2=/(\d{1,3})+(?:\.\d+)?/;//匹配数字
            var startname=data.elem.getAttribute('name');
            var chinese=startname.match(rel1);
            var num=startname.match(rel2);
            /*console.log(chinese[0]);
            console.log(num[0]);*/
            var updataPowerData = {};
            updataPowerData['power']=chinese[0];
            updataPowerData['funlevel']=num[0];
            updataPowerData['onoff']=this.checked?1:0;
            $.ajax({
                url: "/power/updataPower",
                type: 'post',
                contentType: 'application/json;charset=UTF-8',
                dataType: 'json',
                data: JSON.stringify(updataPowerData),
                async: true,
                cache: false,
                success: function (result) {
                    if (result.res) {
                        layer.msg(result.msg, {icon: 1})
                    } else {
                        layer.msg(result.msg, {icon: 5})
                    }
                }
            });
        });
        /*END监听开关*/
    });

</script>


</body>
</html>